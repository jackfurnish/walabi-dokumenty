<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Umowa - WALABI</title>
    <!-- Google Fonts: Plus Jakarta Sans (full charset with Polish diacritics) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700&subset=latin-ext&display=swap" rel="stylesheet">
    <!-- Flatpickr CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <style>
        /* ===== QUIET LUXURY 2026 - TYPOGRAPHY HIERARCHY ===== */
        :root {
            /* Colors */
            --color-primary: #2D2E2E;      /* Deep Anthracite - for DATA */
            --color-secondary: #757575;     /* Warm Grey - for LABELS */
            --color-accent: #B8860B;
            --color-border: #E0E0E0;
            --color-background: #FAFAFA;
            --color-white: #FFFFFF;
            --color-highlight: #F7F5F0;

            /* Typography */
            --font-primary: 'Plus Jakarta Sans', -apple-system, BlinkMacSystemFont, sans-serif;

            /* LABELS: 7pt, Regular, Warm Grey, Uppercase, 0.08em tracking */
            --font-size-label: 7pt;
            --font-weight-label: 400;
            --color-label: #757575;

            /* DATA: 9pt, Semi-bold, Deep Anthracite, Sentence case */
            --font-size-data: 9pt;
            --font-weight-data: 600;
            --color-data: #2D2E2E;

            /* Other sizes */
            --font-size-xs: 6.5pt;
            --font-size-base: 8.5pt;
            --font-size-lg: 10pt;
            --font-size-xl: 12pt;

            /* Spacing */
            --spacing-label-data: 2pt;
            --spacing-xs: 3px;
            --spacing-sm: 6px;
            --spacing-md: 10px;
            --spacing-lg: 14px;
            --spacing-xl: 18px;

            --line-height: 1.4;
            --letter-spacing: 0.08em;
            --letter-spacing-label: 0.08em;
            --border-radius: 2px;
        }

        /* ===== RESET & BASE ===== */
        *, *::before, *::after {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-primary);
            font-size: var(--font-size-base);
            line-height: var(--line-height);
            background: #E8E8E8;
            color: var(--color-primary);
            font-weight: 400;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* ===== FLATPICKR CUSTOMIZATION ===== */
        .flatpickr-calendar {
            font-family: var(--font-primary) !important;
            font-size: 11px !important;
            box-shadow: 0 8px 32px rgba(0,0,0,.12) !important;
            border: 1px solid var(--color-border) !important;
            border-radius: 4px !important;
        }
        .flatpickr-day.selected, .flatpickr-day.selected:hover {
            background: var(--color-primary) !important;
            border-color: var(--color-primary) !important;
        }
        .flatpickr-day:hover {
            background: var(--color-highlight) !important;
        }

        /* ===== LAYOUT ===== */
        .app-wrapper {
            display: flex;
            gap: 20px;
            max-width: 1150px;
            margin: 0 auto;
            padding: 20px;
        }

        /* ===== SIDEBAR ===== */
        .sidebar {
            width: 240px;
            flex-shrink: 0;
            position: sticky;
            top: 20px;
            align-self: flex-start;
        }

        .sidebar-card {
            background: var(--color-white);
            border-radius: 6px;
            padding: 14px;
            margin-bottom: 12px;
            box-shadow: 0 1px 3px rgba(0,0,0,.06);
            border: 1px solid var(--color-border);
        }

        .sidebar-card h3 {
            font-size: var(--font-size-label);
            font-weight: var(--font-weight-label);
            margin-bottom: 10px;
            color: var(--color-label);
            text-transform: uppercase;
            letter-spacing: var(--letter-spacing);
            padding-bottom: 8px;
            border-bottom: 1px solid var(--color-border);
        }

        .sidebar .logo-area {
            text-align: center;
            padding: 12px 0;
        }

        .sidebar .logo-area img {
            max-width: 110px;
            opacity: 0.9;
        }

        .btn {
            display: block;
            width: 100%;
            padding: 10px 12px;
            margin-bottom: 6px;
            font-size: var(--font-size-data);
            font-weight: var(--font-weight-data);
            font-family: var(--font-primary);
            border: none;
            border-radius: 5px;
            cursor: pointer;
            text-align: left;
            transition: all .2s ease;
            letter-spacing: 0.02em;
        }

        .btn:active { transform: scale(.98); }

        .btn-primary {
            background: var(--color-primary);
            color: var(--color-white);
        }
        .btn-primary:hover { background: #1a1a1a; }

        .btn-secondary {
            background: var(--color-background);
            color: var(--color-primary);
            border: 1px solid var(--color-border);
        }
        .btn-secondary:hover { background: var(--color-highlight); }

        .btn-danger {
            background: var(--color-white);
            color: #9A3412;
            border: 1px solid var(--color-border);
        }
        .btn-danger:hover { background: #FEF2F2; }

        /* ===== DOCUMENT ===== */
        .page-container {
            flex: 1;
            min-width: 0;
        }

        .document {
            width: 210mm;
            min-height: 297mm;
            padding: 12mm 14mm;
            background: var(--color-white);
            box-shadow: 0 4px 24px rgba(0,0,0,.08);
            position: relative;
        }

        /* --- HEADER --- */
        .doc-header {
            display: flex;
            align-items: flex-start;
            justify-content: space-between;
            margin-bottom: var(--spacing-md);
        }

        .doc-header .logo img {
            height: 60px;
            opacity: 0.95;
        }

        /* --- DOCUMENT TITLE --- */
        .doc-title {
            text-align: center;
            font-size: var(--font-size-xl);
            font-weight: 700;
            margin: var(--spacing-md) 0;
            padding: var(--spacing-sm) 0;
            text-transform: uppercase;
            letter-spacing: 0.12em;
            color: var(--color-primary);
        }

        .doc-number {
            text-align: center;
            font-size: var(--font-size-lg);
            font-weight: 600;
            margin-bottom: var(--spacing-md);
            color: var(--color-primary);
        }

        .doc-number input {
            border: none;
            border-bottom: 1px solid var(--color-border);
            font-size: var(--font-size-lg);
            font-weight: 600;
            font-family: var(--font-primary);
            text-align: center;
            width: 120px;
            color: var(--color-data);
            background: transparent;
        }

        .doc-number input:focus {
            outline: none;
            border-bottom-color: var(--color-primary);
        }

        /* --- CONTRACT INTRO --- */
        .contract-intro {
            font-size: var(--font-size-base);
            line-height: 1.5;
            margin-bottom: var(--spacing-lg);
        }

        .contract-intro p {
            margin-bottom: var(--spacing-sm);
        }

        .contract-intro .date-place {
            margin-bottom: var(--spacing-md);
        }

        .contract-intro .date-place input {
            border: none;
            border-bottom: 1px solid var(--color-border);
            font-size: var(--font-size-data);
            font-weight: var(--font-weight-data);
            font-family: var(--font-primary);
            background: transparent;
            color: var(--color-data);
            width: 120px;
            text-align: center;
        }

        .contract-intro .date-place input:focus {
            outline: none;
            border-bottom-color: var(--color-primary);
        }

        /* --- PARTY SECTION --- */
        .party-section {
            margin-bottom: var(--spacing-md);
            padding: var(--spacing-sm);
            background: var(--color-highlight);
            border-radius: var(--border-radius);
        }

        .party-title {
            font-size: var(--font-size-label);
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: var(--letter-spacing);
            color: var(--color-primary);
            margin-bottom: var(--spacing-xs);
        }

        .party-details {
            font-size: var(--font-size-base);
            line-height: 1.5;
        }

        .party-details .field-row {
            margin-bottom: 2px;
        }

        .party-details input, .party-details textarea {
            border: none;
            border-bottom: 1px solid var(--color-border);
            font-size: var(--font-size-data);
            font-weight: var(--font-weight-data);
            font-family: var(--font-primary);
            background: transparent;
            color: var(--color-data);
            text-align: center;
        }

        .party-details input:focus, .party-details textarea:focus {
            outline: none;
            border-bottom-color: var(--color-primary);
        }

        .party-details .w-full { width: 100%; }
        .party-details .w-200 { width: 200px; }
        .party-details .w-150 { width: 150px; }
        .party-details .w-120 { width: 120px; }
        .party-details .w-100 { width: 100px; }

        /* --- PARAGRAPH SECTION --- */
        .paragraph-section {
            margin-bottom: var(--spacing-md);
        }

        .paragraph-title {
            font-size: var(--font-size-data);
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--color-primary);
            margin-bottom: var(--spacing-sm);
            padding-bottom: var(--spacing-xs);
            border-bottom: 0.5pt solid var(--color-border);
        }

        .paragraph-content {
            font-size: var(--font-size-base);
            line-height: 1.5;
        }

        .paragraph-content ol {
            margin-left: 16px;
            margin-bottom: var(--spacing-sm);
        }

        .paragraph-content ol li {
            margin-bottom: 4px;
        }

        .paragraph-content ol ol {
            margin-top: 4px;
            list-style-type: decimal;
        }

        .paragraph-content input {
            border: none;
            border-bottom: 1px solid var(--color-border);
            font-size: var(--font-size-data);
            font-weight: var(--font-weight-data);
            font-family: var(--font-primary);
            background: transparent;
            color: var(--color-data);
            text-align: center;
        }

        .paragraph-content input:focus {
            outline: none;
            border-bottom-color: var(--color-primary);
        }

        .paragraph-content .w-60 { width: 60px; }
        .paragraph-content .w-80 { width: 80px; }
        .paragraph-content .w-100 { width: 100px; }
        .paragraph-content .w-150 { width: 150px; }
        .paragraph-content .w-200 { width: 200px; }
        .paragraph-content .w-full { width: 100%; }

        /* --- SIGNATURES --- */
        .signatures-section {
            margin-top: var(--spacing-xl);
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
            page-break-inside: avoid;
        }

        .signature-box {
            text-align: center;
        }

        .signature-box .signature-title {
            font-size: var(--font-size-label);
            font-weight: var(--font-weight-label);
            text-transform: uppercase;
            letter-spacing: var(--letter-spacing);
            color: var(--color-label);
            margin-bottom: var(--spacing-xl);
        }

        .signature-box .signature-line {
            border-top: 1px solid var(--color-border);
            padding-top: var(--spacing-xs);
            font-size: var(--font-size-xs);
            color: var(--color-secondary);
        }

        /* --- FOOTER --- */
        .doc-footer {
            margin-top: var(--spacing-xl);
            padding-top: var(--spacing-md);
            border-top: 0.5pt solid var(--color-border);
            font-size: var(--font-size-xs);
            color: var(--color-primary);
            text-align: center;
            line-height: 1.6;
        }

        /* --- PAGE NUMBER --- */
        .page-number {
            position: absolute;
            top: 10mm;
            right: 14mm;
            font-size: var(--font-size-xs);
            color: var(--color-secondary);
        }

        /* ===== PRINT STYLES ===== */
        @media print {
            html, body {
                background: var(--color-white);
                margin: 0;
                padding: 0;
            }

            .sidebar, .no-print { display: none !important; }

            .app-wrapper {
                padding: 0;
                margin: 0;
            }

            .document {
                box-shadow: none;
                padding: 10mm 12mm;
                width: 210mm;
                min-height: 296mm;
            }

            input, textarea {
                border-color: transparent !important;
                background: transparent !important;
            }

            .party-section {
                print-color-adjust: exact;
                -webkit-print-color-adjust: exact;
            }

            @page {
                size: A4;
                margin: 6mm;
            }
        }

        /* ===== RESPONSIVE ===== */
        @media screen and (max-width: 900px) {
            .app-wrapper {
                flex-direction: column;
                padding: 10px;
            }
            .sidebar {
                width: 100%;
                position: static;
            }
            .document {
                width: 100%;
                min-height: auto;
                padding: 16px;
            }
            .signatures-section {
                grid-template-columns: 1fr;
                gap: var(--spacing-lg);
            }
        }

        /* ===== TOAST ===== */
        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 12px 20px;
            background: var(--color-primary);
            color: var(--color-white);
            border-radius: 6px;
            font-size: 12px;
            font-family: var(--font-primary);
            font-weight: 500;
            box-shadow: 0 8px 24px rgba(0,0,0,.15);
            opacity: 0;
            transform: translateY(20px);
            transition: all .3s ease;
            z-index: 999;
        }

        .toast.show {
            opacity: 1;
            transform: translateY(0);
        }

        .toast.success { background: #166534; }
        .toast.error   { background: #991B1B; }
    </style>
</head>
<body>

<div class="app-wrapper">
    <!-- ===== SIDEBAR ===== -->
    <aside class="sidebar no-print">
        <div class="sidebar-card logo-area">
            <img src="../list-przewozowy/logo.png" alt="WALABI" onerror="this.outerHTML='<div style=&quot;font-size:22px;font-weight:600;color:#2D2E2E;letter-spacing:0.05em&quot;>WALABI<div style=&quot;font-size:8px;color:#757575;font-weight:400;margin-top:2px&quot;>Sp. z o.o. Sp.k.</div></div>'">
        </div>

        <div class="sidebar-card">
            <h3>Akcje</h3>
            <a href="../index.html" class="btn btn-secondary" style="text-decoration:none;margin-bottom:12px;">‚Üê Strona g≈Ç√≥wna</a>
            <button class="btn btn-primary" onclick="printDoc()">Drukuj / Zapisz PDF</button>
            <button class="btn btn-secondary" onclick="exportDOCX()">üìÑ Pobierz DOCX</button>
            <button class="btn btn-secondary" onclick="sendEmail()">‚úâ Wy≈õlij mailem</button>
            <button class="btn btn-secondary" onclick="sendWhatsApp()">üí¨ Wy≈õlij WhatsApp</button>
            <button class="btn btn-danger" onclick="clearForm()">Wyczy≈õƒá formularz</button>
        </div>
    </aside>

    <!-- ===== DOCUMENT ===== -->
    <main class="page-container">
        <div class="document" id="document">

            <!-- Page Number -->
            <div class="page-number">1</div>

            <!-- Header -->
            <div class="doc-header">
                <div class="logo">
                    <img src="../list-przewozowy/logo.png" alt="WALABI" onerror="this.outerHTML='<div style=&quot;font-size:24px;font-weight:600;color:#2D2E2E;letter-spacing:0.05em&quot;>WALABI</div>'">
                </div>
            </div>

            <!-- Title -->
            <div class="doc-title">UMOWA Nr <input type="text" id="docNumber" value="P-XXX-26" style="width:100px;"></div>

            <!-- Contract Intro -->
            <div class="contract-intro">
                <p class="date-place">zawarta w dniu <input type="text" id="contractDate" placeholder="data"> w <input type="text" id="contractPlace" value="Toruniu" style="width:80px;"> pomiƒôdzy:</p>
            </div>

            <!-- Wykonawca -->
            <div class="party-section">
                <div class="party-title">Wykonawca</div>
                <div class="party-details">
                    <p><strong>WALABI Sp√≥≈ÇkƒÖ z ograniczonƒÖ odpowiedzialno≈õciƒÖ Sp√≥≈ÇkƒÖ komandytowƒÖ</strong></p>
                    <p>z siedzibƒÖ w Toruniu, ul. Kosynier√≥w Ko≈õciuszkowskich 13/4, 87-100 Toru≈Ñ,</p>
                    <p>zarejestrowanƒÖ w SƒÖdzie Rejonowym w Toruniu, VII Wydzia≈Ç Gospodarczy Krajowego Rejestru SƒÖdowego</p>
                    <p>pod numerem KRS 0000725731, REGON: 369866245, NIP: 8792700696,</p>
                    <p>reprezentowanƒÖ przez:</p>
                    <p>Leszka Borowskiego ‚Äì e-mail: leszek@walabi.pl, tel. 501 260 990</p>
                    <p>Jaros≈Çawa R√≥≈ºa≈Ñskiego ‚Äì e-mail: jarek@walabi.pl, tel. 501 266 670</p>
                    <p>zwanƒÖ dalej <strong>‚ÄûWykonawcƒÖ"</strong>,</p>
                </div>
            </div>

            <p style="text-align:center;margin:var(--spacing-sm) 0;font-size:var(--font-size-base);">a</p>

            <!-- ZamawiajƒÖcy -->
            <div class="party-section">
                <div class="party-title">ZamawiajƒÖcy</div>
                <div class="party-details">
                    <div class="field-row">
                        <input type="text" id="clientName" class="w-full" placeholder="[Pe≈Çna Nazwa ZamawiajƒÖcego / Firma]">
                    </div>
                    <div class="field-row">
                        z siedzibƒÖ w <input type="text" id="clientCity" class="w-150" placeholder="[Miejscowo≈õƒá]">, <input type="text" id="clientAddress" class="w-200" placeholder="[Adres]">
                    </div>
                    <div class="field-row">
                        NIP <input type="text" id="clientNIP" class="w-120" placeholder="[NIP ZamawiajƒÖcego]">
                    </div>
                    <div class="field-row">
                        tel.: <input type="text" id="clientPhone" class="w-120" placeholder="[Telefon]">, e-mail: <input type="text" id="clientEmail" class="w-150" placeholder="[E-mail]">
                    </div>
                    <p>zwanym dalej <strong>‚ÄûZamawiajƒÖcym"</strong>,</p>
                </div>
            </div>

            <p style="margin:var(--spacing-sm) 0;font-size:var(--font-size-base);">zwanymi ≈ÇƒÖcznie <strong>‚ÄûStronami"</strong>, a ka≈ºdy z osobna <strong>‚ÄûStronƒÖ"</strong>.</p>

            <!-- ¬ß1. PRZEDMIOT UMOWY -->
            <div class="paragraph-section">
                <div class="paragraph-title">¬ß1. Przedmiot Umowy</div>
                <div class="paragraph-content">
                    <ol>
                        <li>ZamawiajƒÖcy zleca, a Wykonawca przyjmuje do realizacji zam√≥wienie obejmujƒÖce produkcjƒô, dostawƒô i monta≈º <input type="text" id="furnitureType" class="w-200" placeholder="[Opis Rodzaju Mebli/Zestawu Meblowego]"> (zwanych dalej "Meblami") wed≈Çug specyfikacji stanowiƒÖcej Za≈ÇƒÖcznik nr 1 do niniejszej Umowy oraz projektu/koncepcji stanowiƒÖcego Za≈ÇƒÖcznik nr 2.</li>
                        <li>Meble zostanƒÖ wykonane i zamontowane w lokalizacji: <input type="text" id="installationAddress" class="w-full" placeholder="[Lokalizacja Monta≈ºu: Pe≈Çny Adres]"></li>
                        <li>Podstawƒô realizacji zam√≥wienia stanowiƒÖ:
                            <ol>
                                <li>Specyfikacja mebli wraz z wycenƒÖ (Za≈ÇƒÖcznik nr 1),</li>
                                <li>Projekt wykonawczy/Koncepcja (Za≈ÇƒÖcznik nr 2),</li>
                                <li>Uzgodnienia poczynione drogƒÖ elektronicznƒÖ (e-mail) pomiƒôdzy Stronami</li>
                                <li>ObowiƒÖzujƒÖce normy i przepisy techniczne.</li>
                            </ol>
                        </li>
                        <li>W przypadku rozbie≈ºno≈õci pomiƒôdzy tre≈õciƒÖ dokument√≥w wymienionych w ust. 3, pierwsze≈Ñstwo majƒÖ postanowienia niniejszej Umowy, nastƒôpnie Za≈ÇƒÖcznik nr 1 i Za≈ÇƒÖcznik nr 2, a nastƒôpnie uzgodnienia poczynione drogƒÖ elektronicznƒÖ.</li>
                    </ol>
                </div>
            </div>

            <!-- ¬ß2. TERMINY REALIZACJI -->
            <div class="paragraph-section">
                <div class="paragraph-title">¬ß2. Terminy Realizacji</div>
                <div class="paragraph-content">
                    <ol>
                        <li>Termin realizacji przedmiotu umowy ustala siƒô na: <input type="text" id="termWeeksFrom" class="w-60" placeholder="[Liczba]"> do <input type="text" id="termWeeksTo" class="w-60" placeholder="[Liczba]"> tygodni od daty podpisania umowy.</li>
                        <li>Przez realizacjƒô przedmiotu umowy rozumie siƒô wykonanie i monta≈º wszystkich Mebli wymienionych w Za≈ÇƒÖczniku nr 1.</li>
                        <li>Termin realizacji mo≈ºe ulec zmianie w przypadku:
                            <ol>
                                <li>Dzia≈Çania si≈Çy wy≈ºszej,</li>
                                <li>Wprowadzenia zmian w projekcie lub specyfikacji przez ZamawiajƒÖcego,</li>
                                <li>Nieterminowego przygotowania miejsca monta≈ºu przez ZamawiajƒÖcego,</li>
                                <li>WystƒÖpienia okoliczno≈õci niezale≈ºnych od Wykonawcy, kt√≥rych nie m√≥g≈Ç on przewidzieƒá przy dochowaniu nale≈ºytej staranno≈õci.</li>
                            </ol>
                        </li>
                    </ol>
                </div>
            </div>

            <!-- ¬ß3. WYNAGRODZENIE -->
            <div class="paragraph-section">
                <div class="paragraph-title">¬ß3. Wynagrodzenie</div>
                <div class="paragraph-content">
                    <ol>
                        <li>Ca≈Çkowite wynagrodzenie za wykonanie przedmiotu Umowy wynosi: <input type="text" id="priceNetto" class="w-100" placeholder="[Kwota]"> z≈Ç netto (s≈Çownie: <input type="text" id="priceNettoWords" class="w-200" placeholder="[s≈Çownie]"> z≈Çotych), co stanowi <input type="text" id="priceBrutto" class="w-100" placeholder="[Kwota]"> z≈Ç brutto (s≈Çownie: <input type="text" id="priceBruttoWords" class="w-200" placeholder="[s≈Çownie]"> z≈Çotych) z uwzglƒôdnieniem podatku VAT 23%.</li>
                        <li>Wynagrodzenie obejmuje: produkcjƒô mebli, transport, wniesienie oraz monta≈º w miejscu wskazanym w ¬ß1 ust. 2.</li>
                        <li>Wynagrodzenie p≈Çatne bƒôdzie w nastƒôpujƒÖcych transzach:
                            <ol>
                                <li>Zaliczka w wysoko≈õci <input type="text" id="advancePercent" class="w-60" placeholder="[%]">% warto≈õci brutto, tj. <input type="text" id="advanceAmount" class="w-100" placeholder="[Kwota]"> z≈Ç, p≈Çatna w terminie <input type="text" id="advanceDays" class="w-60" placeholder="[dni]"> dni od daty podpisania Umowy;</li>
                                <li>Pozosta≈Ça kwota w wysoko≈õci <input type="text" id="remainingPercent" class="w-60" placeholder="[%]">% warto≈õci brutto, tj. <input type="text" id="remainingAmount" class="w-100" placeholder="[Kwota]"> z≈Ç, p≈Çatna w terminie <input type="text" id="remainingDays" class="w-60" placeholder="[dni]"> dni od daty odbioru ko≈Ñcowego.</li>
                            </ol>
                        </li>
                        <li>P≈Çatno≈õci bƒôdƒÖ dokonywane przelewem na rachunek bankowy Wykonawcy: <strong>mBank 31 1140 2004 0000 3302 8257 6928</strong>.</li>
                    </ol>
                </div>
            </div>

            <!-- ¬ß4. OBOWIƒÑZKI STRON -->
            <div class="paragraph-section">
                <div class="paragraph-title">¬ß4. ObowiƒÖzki Stron</div>
                <div class="paragraph-content">
                    <ol>
                        <li>Wykonawca zobowiƒÖzuje siƒô do:
                            <ol>
                                <li>Wykonania przedmiotu Umowy zgodnie ze specyfikacjƒÖ, projektem i zasadami sztuki meblarskiej;</li>
                                <li>U≈ºycia materia≈Ç√≥w wysokiej jako≈õci, zgodnych z ustaleniami;</li>
                                <li>Terminowej realizacji zam√≥wienia;</li>
                                <li>UprzƒÖtniƒôcia miejsca monta≈ºu po zako≈Ñczeniu prac.</li>
                            </ol>
                        </li>
                        <li>ZamawiajƒÖcy zobowiƒÖzuje siƒô do:
                            <ol>
                                <li>Terminowego regulowania p≈Çatno≈õci;</li>
                                <li>Przygotowania miejsca monta≈ºu zgodnie z wytycznymi Wykonawcy;</li>
                                <li>Zapewnienia dostƒôpu do miejsca monta≈ºu w ustalonych terminach;</li>
                                <li>Dokonania odbioru Mebli zgodnie z postanowieniami Umowy.</li>
                            </ol>
                        </li>
                    </ol>
                </div>
            </div>

            <!-- ¬ß5. ODBI√ìR PRZEDMIOTU UMOWY -->
            <div class="paragraph-section">
                <div class="paragraph-title">¬ß5. Odbi√≥r Przedmiotu Umowy</div>
                <div class="paragraph-content">
                    <ol>
                        <li>Po zako≈Ñczeniu monta≈ºu Strony dokonajƒÖ odbioru ko≈Ñcowego, z kt√≥rego zostanie sporzƒÖdzony protok√≥≈Ç odbioru.</li>
                        <li>ZamawiajƒÖcy zobowiƒÖzany jest do zg≈Çoszenia wszelkich uwag i zastrze≈ºe≈Ñ podczas odbioru.</li>
                        <li>Brak zg≈Çoszenia uwag podczas odbioru oznacza akceptacjƒô wykonanych prac.</li>
                        <li>W przypadku stwierdzenia wad, Wykonawca zobowiƒÖzuje siƒô do ich usuniƒôcia w terminie uzgodnionym przez Strony.</li>
                    </ol>
                </div>
            </div>

            <!-- ¬ß6. GWARANCJA I RƒòKOJMIA -->
            <div class="paragraph-section">
                <div class="paragraph-title">¬ß6. Gwarancja i Rƒôkojmia</div>
                <div class="paragraph-content">
                    <ol>
                        <li>Wykonawca udziela <input type="text" id="warrantyYears" class="w-60" placeholder="[Liczba]">-letniej gwarancji na wykonane Meble, liczonej od daty odbioru ko≈Ñcowego.</li>
                        <li>Gwarancja obejmuje wady materia≈Çowe i wykonawcze.</li>
                        <li>Gwarancja nie obejmuje uszkodze≈Ñ mechanicznych powsta≈Çych z winy u≈ºytkownika oraz normalnego zu≈ºycia eksploatacyjnego.</li>
                        <li>Zg≈Çoszenia gwarancyjne nale≈ºy kierowaƒá na adres e-mail: poczta@walabi.pl</li>
                    </ol>
                </div>
            </div>

            <!-- ¬ß7. POSTANOWIENIA KO≈ÉCOWE -->
            <div class="paragraph-section">
                <div class="paragraph-title">¬ß7. Postanowienia Ko≈Ñcowe</div>
                <div class="paragraph-content">
                    <ol>
                        <li>Wszelkie zmiany niniejszej Umowy wymagajƒÖ formy pisemnej pod rygorem niewa≈ºno≈õci.</li>
                        <li>W sprawach nieuregulowanych niniejszƒÖ UmowƒÖ majƒÖ zastosowanie przepisy Kodeksu cywilnego.</li>
                        <li>Ewentualne spory bƒôdƒÖ rozstrzygane przez sƒÖd w≈Ça≈õciwy dla siedziby Wykonawcy.</li>
                        <li>Umowƒô sporzƒÖdzono w dw√≥ch jednobrzmiƒÖcych egzemplarzach, po jednym dla ka≈ºdej ze Stron.</li>
                        <li>IntegralnƒÖ czƒô≈õƒá Umowy stanowiƒÖ:
                            <ol>
                                <li>Za≈ÇƒÖcznik nr 1 ‚Äì Specyfikacja mebli wraz z wycenƒÖ</li>
                                <li>Za≈ÇƒÖcznik nr 2 ‚Äì Projekt wykonawczy/Koncepcja</li>
                            </ol>
                        </li>
                    </ol>
                </div>
            </div>

            <!-- Signatures -->
            <div class="signatures-section">
                <div class="signature-box">
                    <div class="signature-title">Wykonawca</div>
                    <div class="signature-line">podpis i pieczƒôƒá</div>
                </div>
                <div class="signature-box">
                    <div class="signature-title">ZamawiajƒÖcy</div>
                    <div class="signature-line">podpis i pieczƒôƒá</div>
                </div>
            </div>

            <!-- Footer -->
            <div class="doc-footer">
                <div class="company-legal">WALABI Sp. z o.o. Sp.k. ¬∑ ul. Kosynier√≥w Ko≈õciuszkowskich 13/4 ¬∑ 87-100 Toru≈Ñ</div>
                <div class="company-registration">KRS: 0000725731 ¬∑ NIP: 8792700696 ¬∑ REGON: 369866245 ¬∑ Tel: +48 501 260 990 ¬∑ poczta@walabi.pl</div>
            </div>

        </div>
    </main>
</div>

<!-- Toast -->
<div id="toast" class="toast"></div>

<!-- Flatpickr JS -->
<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
<script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/pl.js"></script>

<!-- docx library for DOCX export -->
<script src="https://unpkg.com/docx@8.2.2/build/index.umd.js"></script>

<script>
    // ===== FLATPICKR INIT =====
    flatpickr.localize(flatpickr.l10ns.pl);

    flatpickr("#contractDate", {
        dateFormat: "d.m.Y",
        defaultDate: new Date()
    });

    // ===== PRINT =====
    function printDoc() {
        window.print();
        toast('Otwarto okno drukowania');
    }

    // ===== EMAIL =====
    window.sendEmail = function() {
        const docNum = document.getElementById('docNumber').value || 'Umowa';
        const client = document.getElementById('clientName').value || '';
        const subject = encodeURIComponent(`WALABI - ${docNum}${client ? ' - ' + client : ''}`);
        const body = encodeURIComponent(`Dzie≈Ñ dobry,\n\nW za≈ÇƒÖczeniu przesy≈Çam ${docNum}.\n\nZ powa≈ºaniem,\nWALABI Sp. z o.o. Sp.k.`);
        window.open(`mailto:?subject=${subject}&body=${body}`, '_blank');
        toast('Otwarto klienta email');
    };

    // ===== WHATSAPP =====
    window.sendWhatsApp = function() {
        const docNum = document.getElementById('docNumber').value || 'Umowa';
        const client = document.getElementById('clientName').value || '';
        const text = encodeURIComponent(`Dzie≈Ñ dobry,\n\nW za≈ÇƒÖczeniu przesy≈Çam ${docNum}${client ? ' dla ' + client : ''} z WALABI.`);
        window.open(`https://wa.me/?text=${text}`, '_blank');
        toast('Otwarto WhatsApp');
    };

    // ===== CLEAR FORM =====
    function clearForm() {
        if (confirm('Czy na pewno chcesz wyczy≈õciƒá formularz?')) {
            document.querySelectorAll('input[type="text"]').forEach(input => {
                if (input.id !== 'contractPlace') {
                    input.value = '';
                }
            });
            document.getElementById('docNumber').value = 'P-XXX-26';
            flatpickr("#contractDate", {
                dateFormat: "d.m.Y",
                defaultDate: new Date()
            });
            toast('Formularz wyczyszczony');
        }
    }

    // ===== EXPORT DOCX =====
    async function exportDOCX() {
        toast('Generowanie DOCX...');

        const { Document, Packer, Paragraph, TextRun, HeadingLevel, AlignmentType } = docx;

        const docNum = document.getElementById('docNumber').value || 'P-XXX-26';
        const contractDate = document.getElementById('contractDate').value || '';
        const contractPlace = document.getElementById('contractPlace').value || 'Toruniu';
        const clientName = document.getElementById('clientName').value || '';
        const clientCity = document.getElementById('clientCity').value || '';
        const clientAddress = document.getElementById('clientAddress').value || '';
        const clientNIP = document.getElementById('clientNIP').value || '';
        const clientPhone = document.getElementById('clientPhone').value || '';
        const clientEmail = document.getElementById('clientEmail').value || '';
        const furnitureType = document.getElementById('furnitureType').value || '';
        const installationAddress = document.getElementById('installationAddress').value || '';
        const termWeeksFrom = document.getElementById('termWeeksFrom').value || '';
        const termWeeksTo = document.getElementById('termWeeksTo').value || '';
        const priceNetto = document.getElementById('priceNetto').value || '';
        const priceNettoWords = document.getElementById('priceNettoWords').value || '';
        const priceBrutto = document.getElementById('priceBrutto').value || '';
        const priceBruttoWords = document.getElementById('priceBruttoWords').value || '';
        const advancePercent = document.getElementById('advancePercent').value || '';
        const advanceAmount = document.getElementById('advanceAmount').value || '';
        const advanceDays = document.getElementById('advanceDays').value || '';
        const remainingPercent = document.getElementById('remainingPercent').value || '';
        const remainingAmount = document.getElementById('remainingAmount').value || '';
        const remainingDays = document.getElementById('remainingDays').value || '';
        const warrantyYears = document.getElementById('warrantyYears').value || '';

        const doc = new Document({
            sections: [{
                properties: {},
                children: [
                    new Paragraph({
                        children: [new TextRun({ text: `UMOWA Nr ${docNum}`, bold: true, size: 32 })],
                        alignment: AlignmentType.CENTER,
                        spacing: { after: 400 }
                    }),
                    new Paragraph({
                        children: [new TextRun({ text: `zawarta w dniu ${contractDate} w ${contractPlace} pomiƒôdzy:`, size: 22 })],
                        spacing: { after: 200 }
                    }),
                    new Paragraph({
                        children: [new TextRun({ text: "WYKONAWCA:", bold: true, size: 22 })],
                        spacing: { before: 200, after: 100 }
                    }),
                    new Paragraph({
                        children: [new TextRun({ text: "WALABI Sp√≥≈ÇkƒÖ z ograniczonƒÖ odpowiedzialno≈õciƒÖ Sp√≥≈ÇkƒÖ komandytowƒÖ", bold: true, size: 22 })],
                    }),
                    new Paragraph({
                        children: [new TextRun({ text: "z siedzibƒÖ w Toruniu, ul. Kosynier√≥w Ko≈õciuszkowskich 13/4, 87-100 Toru≈Ñ,", size: 22 })],
                    }),
                    new Paragraph({
                        children: [new TextRun({ text: "KRS 0000725731, REGON: 369866245, NIP: 8792700696,", size: 22 })],
                    }),
                    new Paragraph({
                        children: [new TextRun({ text: 'zwanƒÖ dalej ‚ÄûWykonawcƒÖ",', size: 22 })],
                        spacing: { after: 200 }
                    }),
                    new Paragraph({
                        children: [new TextRun({ text: "a", size: 22 })],
                        alignment: AlignmentType.CENTER,
                        spacing: { after: 200 }
                    }),
                    new Paragraph({
                        children: [new TextRun({ text: "ZAMAWIAJƒÑCY:", bold: true, size: 22 })],
                        spacing: { after: 100 }
                    }),
                    new Paragraph({
                        children: [new TextRun({ text: clientName || "[Pe≈Çna Nazwa ZamawiajƒÖcego / Firma]", bold: true, size: 22 })],
                    }),
                    new Paragraph({
                        children: [new TextRun({ text: `z siedzibƒÖ w ${clientCity || "[Miejscowo≈õƒá]"}, ${clientAddress || "[Adres]"}`, size: 22 })],
                    }),
                    new Paragraph({
                        children: [new TextRun({ text: `NIP ${clientNIP || "[NIP]"}`, size: 22 })],
                    }),
                    new Paragraph({
                        children: [new TextRun({ text: `tel.: ${clientPhone || "[Telefon]"}, e-mail: ${clientEmail || "[E-mail]"}`, size: 22 })],
                    }),
                    new Paragraph({
                        children: [new TextRun({ text: 'zwanym dalej ‚ÄûZamawiajƒÖcym",', size: 22 })],
                        spacing: { after: 200 }
                    }),
                    new Paragraph({
                        children: [new TextRun({ text: 'zwanymi ≈ÇƒÖcznie ‚ÄûStronami", a ka≈ºdy z osobna ‚ÄûStronƒÖ".', size: 22 })],
                        spacing: { after: 400 }
                    }),
                    // ¬ß1
                    new Paragraph({
                        children: [new TextRun({ text: "¬ß1. PRZEDMIOT UMOWY", bold: true, size: 24 })],
                        spacing: { before: 300, after: 200 }
                    }),
                    new Paragraph({
                        children: [new TextRun({ text: `1. ZamawiajƒÖcy zleca, a Wykonawca przyjmuje do realizacji zam√≥wienie obejmujƒÖce produkcjƒô, dostawƒô i monta≈º ${furnitureType || "[Opis Rodzaju Mebli]"} wed≈Çug specyfikacji stanowiƒÖcej Za≈ÇƒÖcznik nr 1 oraz projektu stanowiƒÖcego Za≈ÇƒÖcznik nr 2.`, size: 22 })],
                        spacing: { after: 100 }
                    }),
                    new Paragraph({
                        children: [new TextRun({ text: `2. Meble zostanƒÖ zamontowane w lokalizacji: ${installationAddress || "[Lokalizacja Monta≈ºu]"}`, size: 22 })],
                        spacing: { after: 200 }
                    }),
                    // ¬ß2
                    new Paragraph({
                        children: [new TextRun({ text: "¬ß2. TERMINY REALIZACJI", bold: true, size: 24 })],
                        spacing: { before: 300, after: 200 }
                    }),
                    new Paragraph({
                        children: [new TextRun({ text: `1. Termin realizacji: ${termWeeksFrom || "[Liczba]"} do ${termWeeksTo || "[Liczba]"} tygodni od daty podpisania umowy.`, size: 22 })],
                        spacing: { after: 200 }
                    }),
                    // ¬ß3
                    new Paragraph({
                        children: [new TextRun({ text: "¬ß3. WYNAGRODZENIE", bold: true, size: 24 })],
                        spacing: { before: 300, after: 200 }
                    }),
                    new Paragraph({
                        children: [new TextRun({ text: `1. Wynagrodzenie: ${priceNetto || "[Kwota]"} z≈Ç netto (${priceNettoWords || "[s≈Çownie]"}), ${priceBrutto || "[Kwota]"} z≈Ç brutto (${priceBruttoWords || "[s≈Çownie]"}) z VAT 23%.`, size: 22 })],
                        spacing: { after: 100 }
                    }),
                    new Paragraph({
                        children: [new TextRun({ text: `2. Zaliczka: ${advancePercent || "[%]"}% = ${advanceAmount || "[Kwota]"} z≈Ç, p≈Çatna w ${advanceDays || "[dni]"} dni od podpisania.`, size: 22 })],
                        spacing: { after: 100 }
                    }),
                    new Paragraph({
                        children: [new TextRun({ text: `3. Pozosta≈Ça kwota: ${remainingPercent || "[%]"}% = ${remainingAmount || "[Kwota]"} z≈Ç, p≈Çatna w ${remainingDays || "[dni]"} dni od odbioru.`, size: 22 })],
                        spacing: { after: 100 }
                    }),
                    new Paragraph({
                        children: [new TextRun({ text: "4. Nr konta: mBank 31 1140 2004 0000 3302 8257 6928", size: 22 })],
                        spacing: { after: 200 }
                    }),
                    // ¬ß6
                    new Paragraph({
                        children: [new TextRun({ text: "¬ß6. GWARANCJA", bold: true, size: 24 })],
                        spacing: { before: 300, after: 200 }
                    }),
                    new Paragraph({
                        children: [new TextRun({ text: `1. Gwarancja: ${warrantyYears || "[Liczba]"} lat od daty odbioru ko≈Ñcowego.`, size: 22 })],
                        spacing: { after: 400 }
                    }),
                    // Signatures
                    new Paragraph({
                        children: [
                            new TextRun({ text: "______________________", size: 22 }),
                            new TextRun({ text: "                                        ", size: 22 }),
                            new TextRun({ text: "______________________", size: 22 })
                        ],
                        spacing: { before: 600 }
                    }),
                    new Paragraph({
                        children: [
                            new TextRun({ text: "        Wykonawca        ", size: 20 }),
                            new TextRun({ text: "                                                    ", size: 20 }),
                            new TextRun({ text: "        ZamawiajƒÖcy        ", size: 20 })
                        ]
                    })
                ]
            }]
        });

        const blob = await Packer.toBlob(doc);
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `Umowa_${docNum.replace(/\//g, '-')}_${clientName || 'WALABI'}.docx`;
        a.click();
        URL.revokeObjectURL(url);

        toast('Pobrano plik DOCX', 'success');
    }

    // ===== TOAST =====
    function toast(msg, type) {
        const el = document.getElementById('toast');
        el.textContent = msg;
        el.className = 'toast show' + (type ? ' ' + type : '');
        setTimeout(() => el.className = 'toast', 3000);
    }

    // ===== FORMATOWANIE KWOT =====
    function formatCurrency(value) {
        return value.toLocaleString('pl-PL', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
    }

    function parseNumber(str) {
        if (!str) return 0;
        // Usu≈Ñ spacje i zamie≈Ñ przecinek na kropkƒô
        return parseFloat(str.replace(/\s/g, '').replace(',', '.')) || 0;
    }

    // ===== KWOTA S≈ÅOWNIE =====
    function numberToWords(num) {
        const ones = ['', 'jeden', 'dwa', 'trzy', 'cztery', 'piƒôƒá', 'sze≈õƒá', 'siedem', 'osiem', 'dziewiƒôƒá'];
        const teens = ['dziesiƒôƒá', 'jedena≈õcie', 'dwana≈õcie', 'trzyna≈õcie', 'czterna≈õcie', 'piƒôtna≈õcie', 'szesna≈õcie', 'siedemna≈õcie', 'osiemna≈õcie', 'dziewiƒôtna≈õcie'];
        const tens = ['', 'dziesiƒôƒá', 'dwadzie≈õcia', 'trzydzie≈õci', 'czterdzie≈õci', 'piƒôƒádziesiƒÖt', 'sze≈õƒádziesiƒÖt', 'siedemdziesiƒÖt', 'osiemdziesiƒÖt', 'dziewiƒôƒádziesiƒÖt'];
        const hundreds = ['', 'sto', 'dwie≈õcie', 'trzysta', 'czterysta', 'piƒôƒáset', 'sze≈õƒáset', 'siedemset', 'osiemset', 'dziewiƒôƒáset'];

        function getThousandForm(n) {
            if (n === 1) return 'tysiƒÖc';
            if (n >= 2 && n <= 4) return 'tysiƒÖce';
            if (n >= 5 && n <= 21) return 'tysiƒôcy';
            const lastDigit = n % 10;
            if (lastDigit >= 2 && lastDigit <= 4) return 'tysiƒÖce';
            return 'tysiƒôcy';
        }

        function getMillionForm(n) {
            if (n === 1) return 'milion';
            if (n >= 2 && n <= 4) return 'miliony';
            if (n >= 5 && n <= 21) return 'milion√≥w';
            const lastDigit = n % 10;
            if (lastDigit >= 2 && lastDigit <= 4) return 'miliony';
            return 'milion√≥w';
        }

        function convertHundreds(n) {
            if (n === 0) return '';
            let result = '';
            const h = Math.floor(n / 100);
            const remainder = n % 100;
            if (h > 0) result += hundreds[h] + ' ';
            if (remainder >= 10 && remainder < 20) {
                result += teens[remainder - 10];
            } else {
                const t = Math.floor(remainder / 10);
                const o = remainder % 10;
                if (t > 0) result += tens[t] + ' ';
                if (o > 0) result += ones[o];
            }
            return result.trim();
        }

        if (num === 0) return 'zero';

        const intPart = Math.floor(num);
        const grosze = Math.round((num - intPart) * 100);

        let result = '';

        // Miliony
        const millions = Math.floor(intPart / 1000000);
        if (millions > 0) {
            result += convertHundreds(millions) + ' ' + getMillionForm(millions) + ' ';
        }

        // TysiƒÖce
        const thousands = Math.floor((intPart % 1000000) / 1000);
        if (thousands > 0) {
            result += convertHundreds(thousands) + ' ' + getThousandForm(thousands) + ' ';
        }

        // Setki, dziesiƒÖtki, jedno≈õci
        const rest = intPart % 1000;
        if (rest > 0) {
            result += convertHundreds(rest);
        }

        result = result.trim();

        // Dodaj grosze
        if (grosze > 0) {
            result += ' ' + grosze.toString().padStart(2, '0') + '/100';
        }

        return result;
    }

    // ===== PRZELICZANIE KWOT =====
    function calculatePrices() {
        const netto = parseNumber(document.getElementById('priceNetto').value);
        const advancePercent = parseNumber(document.getElementById('advancePercent').value);

        if (netto > 0) {
            // Oblicz brutto (VAT 23%)
            const brutto = netto * 1.23;
            document.getElementById('priceBrutto').value = formatCurrency(brutto);

            // S≈Çownie
            document.getElementById('priceNettoWords').value = numberToWords(netto);
            document.getElementById('priceBruttoWords').value = numberToWords(brutto);

            // Oblicz zaliczkƒô i pozosta≈ÇƒÖ kwotƒô
            if (advancePercent > 0) {
                const advanceAmount = brutto * (advancePercent / 100);
                const remainingPercent = 100 - advancePercent;
                const remainingAmount = brutto - advanceAmount;

                document.getElementById('advanceAmount').value = formatCurrency(advanceAmount);
                document.getElementById('remainingPercent').value = remainingPercent;
                document.getElementById('remainingAmount').value = formatCurrency(remainingAmount);
            }
        }
    }

    // ===== SET DEFAULT DATE =====
    document.addEventListener('DOMContentLoaded', function() {
        const today = new Date();
        const formattedDate = today.toLocaleDateString('pl-PL', { day: '2-digit', month: '2-digit', year: 'numeric' });
        document.getElementById('contractDate').value = formattedDate;

        // Dodaj event listenery do p√≥l z kwotami
        document.getElementById('priceNetto').addEventListener('input', calculatePrices);
        document.getElementById('priceNetto').addEventListener('blur', function() {
            const val = parseNumber(this.value);
            if (val > 0) this.value = formatCurrency(val);
        });

        document.getElementById('advancePercent').addEventListener('input', calculatePrices);
    });
</script>

</body>
</html>
